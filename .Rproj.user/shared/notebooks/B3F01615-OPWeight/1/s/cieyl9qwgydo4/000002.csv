"0","# initial stage--------"
"0","pvals = de_res_air$pvalue"
"0","tests = qnorm(pvals/2, lower.tail = FALSE)"
"0","filters = de_res_air$baseMean + .0001"
"0","Data <- tibble(pvals, tests, filters)"
"0","# estimate the true null and alternative test sizes------"
"0","m = length(Data$pvals); m"
"1","[1]"
"1"," 64102"
"1","
"
"0","null = qvalue(Data$pvals, pi0.method=""bootstrap"")$pi0; null"
"1","[1]"
"1"," 0.8987773"
"1","
"
"0","m0 = ceiling(null*m); m0"
"1","[1]"
"1"," 57614"
"1","
"
"0","m1 = m - m0; m1"
"1","[1]"
"1"," 6488"
"1","
"
"0","# fit box-cox regression"
"0","#--------------------------------"
"0","bc <- boxcox(Data$filters ~ Data$tests)"
