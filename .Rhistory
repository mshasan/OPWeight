library(OPWeight)
library(OPWeight)
library(OPWeight)
warnngs()
library(OPWeight)
library(IHWpaper)
proteomics_file <- system.file("extdata/real_data","science_signaling.csv", package = "IHWpaper")
proteomics_df <- read.csv(proteomics_file, stringsAsFactors = F)
proteomics_df$pvalue <- rank(proteomics_df$p1, ties.method="first")*proteomics_df$p1/nrow(proteomics_df)
proteomics_df$test = qnorm(proteomics_df$pvalue, lower.tail = F)
names(proteomics_df)
test = proteomics_df$test
pval = proteomics_df$pvalue
filter = proteomics_df$X..peptides
res = opw(pvalue = pval, filter = filters, test = tests, effectType = "continuous",
alpha = .05, method = "BH")
tests = proteomics_df$test
pvals = proteomics_df$pvalue
filters = proteomics_df$X..peptides
res = opw(pvalue = pval, filter = filters, test = tests, effectType = "continuous",
alpha = .05, method = "BH")
names(res)
res$totalTests
res$propNulls
res$rejections
res$rejections_list
ranks <- 1:length(pvals)
ranks
seq(.05, .1, .01)
n_rej_cont <- NULL
n_rej_bin <- NULL
for(alphaVal in seq(.05, .1, .01))
{
res_cont = opw(pvalue = pval, filter = filters, test = tests, effectType = "continuous",
alpha = alphaVal, method = "BH")
res_bin = opw(pvalue = pval, filter = filters, test = tests, effectType = "binary",
alpha = alphaVal, method = "BH")
n_rej_cont <- c(n_rej_cont, res$rejections)
n_rej_bin <- c(n_rej_bin)
}
n_rej_cont <- NULL
n_rej_bin <- NULL
for(alphaVal in seq(.05, .1, .01))
{
res_cont = opw(pvalue = pval, filter = filters, test = tests, effectType = "continuous",
alpha = alphaVal, method = "BH")
res_bin = opw(pvalue = pval, filter = filters, test = tests, effectType = "binary",
alpha = alphaVal, method = "BH")
n_rej_cont <- c(n_rej_cont, res_cont$rejections)
n_rej_bin <- c(n_rej_bin, res_bin$rejections)
}
n_rej_cont
n_rej_bin
proteomics_file <- system.file("real_data_examples/result_files", "proteomics_benchmark.Rds", package = "IHWpaper")
proteomics_data <- readRDS(file=proteomics_file)
panel_c_data <- group_by(proteomics_data$alpha_df, alpha) %>% summarize(BH = max(bh_rejections), IHW=max(rejections)) %>%
gather(method, rejections, BH, IHW)
panel_c_data <- group_by(proteomics_data$alpha_df, alpha) %>% summarize(BH = max(bh_rejections), IHW=max(rejections)) %>%
gather(method, rejections, BH, IHW)
group_by(proteomics_data$alpha_df, alpha)
alpha
seq(.05, length = 5)
seq(.05, .1, length = 5)
alpha = seq(.05, .1, length = 5)
panel_c_data <- group_by(proteomics_data$alpha_df, alpha) %>% summarize(BH = max(bh_rejections), IHW=max(rejections)) %>%
gather(method, rejections, BH, IHW)
rej_mat_prot_FDR <- data.frame(alphaVec, t(rej_mat_prot[5:7,]),IHW=c(192, 216, 238, 262, 271))
proteomics_data
group_by(proteomics_data$alpha_df, alpha)
library(IHW)
panel_c_data <- group_by(proteomics_data$alpha_df, alpha) %>% summarize(BH = max(bh_rejections), IHW=max(rejections)) %>%
gather(method, rejections, BH, IHW)
rej_mat_prot_FDR <- data.frame(alphaVec, t(rej_mat_prot[5:7,]),IHW=c(192, 216, 238, 262, 271))
library(IHWpaper)
panel_c_data <- group_by(proteomics_data$alpha_df, alpha) %>% summarize(BH = max(bh_rejections), IHW=max(rejections)) %>%
gather(method, rejections, BH, IHW)
group_by(proteomics_data$alpha_df, alpha)
proteomics_file <- system.file("real_data_examples/result_files", "proteomics_benchmark.Rds", package = "IHWpaper")
proteomics_data <- readRDS(file=proteomics_file)
panel_c_data <- group_by(proteomics_data$alpha_df, alpha) %>% summarize(BH = max(bh_rejections), IHW=max(rejections)) %>%
gather(method, rejections, BH, IHW)
alpha
proteomics_data$alpha_df
